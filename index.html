<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TOEIC è½åŠ›ç·´ç¿’</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
    .question { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 8px; }
    .question h3 { margin-top: 0; }
    button { padding: 10px 20px; margin: 5px; cursor: pointer; border: none; border-radius: 5px; }
    .play-btn { background: #4CAF50; color: white; }
    .check-btn { background: #2196F3; color: white; }
    .next-btn { background: #FF9800; color: white; }
    .options button { display: block; width: 100%; margin: 5px 0; text-align: left; background: #fff; border: 1px solid #ddd; }
    .options button:hover { background: #e3f2fd; }
    .correct { background: #c8e6c9 !important; }
    .wrong { background: #ffcdd2 !important; }
    #result { margin-top: 20px; font-size: 18px; font-weight: bold; }
    
    /* æ–°å¢æ¨£å¼ */
    .progress-container { background: #e0e0e0; border-radius: 10px; height: 20px; margin: 15px 0; overflow: hidden; }
    .progress-bar { background: #4CAF50; height: 100%; transition: width 0.3s ease; }
    .progress-text { text-align: center; font-size: 14px; margin-bottom: 10px; }
    
    .score-display { background: #e3f2fd; padding: 10px; border-radius: 8px; margin: 10px 0; text-align: center; }
    .score-display .score { font-size: 24px; font-weight: bold; color: #1976D2; }
    .score-display .estimate { font-size: 14px; color: #666; margin-top: 5px; }
    
    .question-image { margin-bottom: 15px; }
.question-image img { max-width: 100%; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }

.explanation { background: #fff3e0; padding: 12px; border-radius: 8px; margin-top: 10px; border-left: 4px solid #FF9800; }
    .explanation strong { color: #E65100; }
    
    .speed-control { background: #fce4ec; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
    .speed-control label { display: block; margin-bottom: 8px; font-weight: bold; color: #c2185b; }
    .speed-control input[type="range"] { width: 100%; }
    .speed-value { text-align: center; font-weight: bold; color: #c2185b; }
  </style>
</head>
<body>
  <h1>ğŸ“ TOEIC è½åŠ›ç·´ç¿’</h1>
  
  <!-- èªé€Ÿæ§åˆ¶ -->
  <div class="speed-control">
    <label>ğŸ”Š èªé€Ÿæ§åˆ¶</label>
    <input type="range" id="speedSlider" min="0.5" max="1.5" step="0.1" value="0.8" oninput="updateSpeed()">
    <div class="speed-value">ç›®å‰èªé€Ÿ: <span id="speedValue">0.8</span>x</div>
  </div>
  
  <p>é»æ“Šã€Œæ’­æ”¾é¡Œç›®ã€è†è½å•é¡Œï¼Œç„¶å¾Œé¸æ“‡æ­£ç¢ºç­”æ¡ˆ</p>
  
  <!-- é€²åº¦æ¢ -->
  <div class="progress-container">
    <div class="progress-bar" id="progressBar" style="width: 0%"></div>
  </div>
  <div class="progress-text" id="progressText">é€²åº¦: 0%</div>
  
  <!-- åˆ†æ•¸é¡¯ç¤º -->
  <div class="score-display">
    <div class="score">ç›®å‰å¾—åˆ†: <span id="currentScore">0</span> / <span id="totalQuestions">0</span></div>
    <div class="estimate" id="scoreEstimate">é ä¼°å¤šç›Šåˆ†æ•¸: ---</div>
  </div>
  
  <div id="quiz">
    <div style="text-align: center; padding: 40px;">
      <h2>ğŸ§ TOEIC è½åŠ›ç·´ç¿’</h2>
      <button class="play-btn" onclick="loadQuestion()" style="font-size: 18px; padding: 15px 30px;">é–‹å§‹æ¸¬é©— â–¶ï¸</button>
    </div>
  </div>
  <div id="result"></div>

  <script>
    let speechRate = 0.8;
    let currentQuestion = 0;
    let score = 0;
    let answered = false;
    let questions = [];

    // Question data
    questions = [
      // Part 1: ç…§ç‰‡æè¿°
      { part: 1, image: "part1-q1.jpg", text: "Look at the picture. What do you see?", options: ["People working in a modern office.", "The window is closed.", "There are no documents.", "Employees having lunch."], answer: 0, explanation: "åœ–ç‰‡é¡¯ç¤ºç¾ä»£è¾¦å…¬å®¤ã€‚" },
      { part: 1, image: "part1-q2.jpg", text: "Look at the picture. What do you see?", options: ["A bench in a park near trees.", "The park is empty.", "People playing sports.", "No trees in the area."], answer: 0, explanation: "åœ–ç‰‡é¡¯ç¤ºå…¬åœ’è£¡æœ‰é•·æ¤…å’Œæ¨¹æœ¨ã€‚" },
      { part: 1, image: "part1-q3.jpg", text: "Look at the picture. What do you see?", options: ["A chef cooking in the kitchen.", "Restaurant is closed.", "Stove is turned off.", "Customers waiting for food."], answer: 0, explanation: "åœ–ç‰‡é¡¯ç¤ºå»šå¸«æ­£åœ¨çƒ¹é£ªã€‚" },
      // Part 2: æ‡‰ç­”å•é¡Œ
      { part: 2, question: "Could you pass me the stapler, please?", options: ["Sure, here you go.", "I don't know where it is.", "The meeting starts at 3 PM."], answer: 0, explanation: "é€™æ˜¯è«‹æ±‚å¥ã€‚" },
      { part: 2, question: "Thank you for helping me with the project.", options: ["You're welcome.", "I need more time.", "Let me check my schedule."], answer: 0, explanation: "é€™æ˜¯è¡¨é”æ„Ÿè¬ã€‚" },
      { part: 2, question: "Would you like to join us for dinner tonight?", options: ["That sounds great! What time?", "I'm not hungry.", "I had dinner already."], answer: 0, explanation: "é€™æ˜¯é‚€è«‹ã€‚" },
      // Part 3: ç°¡çŸ­å°è©±
      { part: 3, text: "W: Hi John, do you have a moment? M: Sure, what's up? W: The client requested some changes. M: That shouldn't be a problem. | Q: What are they discussing?", options: ["A project deadline change", "A new client", "A team party"], answer: 0, explanation: "å°è©±æåˆ°å®¢æˆ¶è¦æ±‚è®Šæ›´ã€‚" },
      { part: 3, text: "W: Excuse me, I reserved a room. M: May I have your name? W: It's under Smith. M: Yes, we have a double room ready. | Q: Where is this?", options: ["At a hotel", "At a restaurant", "At a library"], answer: 0, explanation: "å°è©±æåˆ°é è¨‚æˆ¿é–“ã€‚" },
      { part: 3, text: "M: I'm going to the conference next week. W: What will you do there? M: I'll present our new product. | Q: What will the man do?", options: ["Give a presentation", "Organize the event", "Take notes"], answer: 0, explanation: "ç”·äººèªªä»–æœƒå±•ç¤ºæ–°ç”¢å“ã€‚" },
      // Part 4: ç°¡çŸ­ç¨ç™½
      { part: 4, text: "Announcement: The company picnic this Saturday has been postponed to next Sunday due to weather. Please update your calendars. | Q: Why was it postponed?", options: ["Due to weather forecast", "Low attendance", "Budget issues"], answer: 0, explanation: "å…¬å‘Šèªªå› ç‚ºå¤©æ°£é å ±ã€‚" },
      { part: 4, text: "Museum: We are open from 9 AM to 5 PM, Tuesday to Sunday. Admission is $15 for adults. Flash photography is not allowed. | Q: When is the museum closed?", options: ["On Mondays", "On Sundays", "On holidays"], answer: 0, explanation: "é–‹æ”¾æ™‚é–“æ˜¯é€±äºŒåˆ°é€±æ—¥ã€‚" },
      { part: 4, text: "Flight announcement: We are experiencing turbulence due to weather. Please keep your seatbelts fastened. We expect to land on time. | Q: What should passengers do?", options: ["Keep seatbelts fastened", "Stand up", "Move to exit"], answer: 0, explanation: "æ©Ÿé•·è¦æ±‚ä¹˜å®¢ç¹«å¥½å®‰å…¨å¸¶ã€‚" }
    ];

    // Shuffle questions
    for (let i = questions.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [questions[i], questions[j]] = [questions[j], questions[i]];
    }

    function updateSpeed() {
      speechRate = parseFloat(document.getElementById('speedSlider').value);
      document.getElementById('speedValue').textContent = speechRate.toFixed(1);
    }

    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US';
      utterance.rate = speechRate;
      speechSynthesis.speak(utterance);
    }

    function updateDisplay() {
      document.getElementById('currentScore').textContent = score;
      document.getElementById('totalQuestions').textContent = questions.length;
      document.getElementById('progressBar').style.width = (currentQuestion / questions.length * 100) + '%';
      document.getElementById('progressText').textContent = 'é€²åº¦: ' + currentQuestion + ' / ' + questions.length;
      
      if (currentQuestion > 0 && score > 0) {
        const percent = Math.round((score / currentQuestion) * 100);
        const estimate = Math.round(200 + (percent * 7.9));
        document.getElementById('scoreEstimate').textContent = 'é ä¼°å¤šç›Šåˆ†æ•¸: ' + estimate + ' - ' + (estimate + 45) + ' åˆ†';
      } else {
        document.getElementById('scoreEstimate').textContent = 'é ä¼°å¤šç›Šåˆ†æ•¸: ---';
      }
    }

    function loadQuestion() {
      if (currentQuestion >= questions.length) {
        document.getElementById('quiz').innerHTML = '<div class="question"><h2>ğŸ‰ æ¸¬é©—å®Œæˆï¼</h2><p>æœ€çµ‚å¾—åˆ†: ' + score + ' / ' + questions.length + '</p><p class="estimate">' + document.getElementById('scoreEstimate').textContent + '</p><button class="play-btn" onclick="location.reload()">é‡æ–°é–‹å§‹</button></div>';
        return;
      }

      answered = false;
      const q = questions[currentQuestion];
      const qText = q.question || q.text;

      let html = '<div class="question-image">';
      if (q.image) html += '<img src="' + q.image + '" alt="Question image" style="max-width:100%; border-radius:8px; margin-bottom:15px;">';
      html += '</div><div class="question"><h3>é¡Œç›® ' + (currentQuestion + 1) + ' / ' + questions.length + '</h3>';
      html += '<button class="play-btn" onclick="speak(\'' + qText.replace(/'/g, "\\'") + '\')">ğŸ”Š æ’­æ”¾é¡Œç›®</button>';
      html += '<div class="options">';
      for (let i = 0; i < q.options.length; i++) {
        html += '<button onclick="checkAnswer(' + i + ')">' + String.fromCharCode(65+i) + '. ' + q.options[i] + '</button>';
      }
      html += '</div></div>';
      
      document.getElementById('quiz').innerHTML = html;
    }

    function checkAnswer(selected) {
      if (answered) return;
      answered = true;
      
      const q = questions[currentQuestion];
      const buttons = document.querySelectorAll('.options button');
      
      if (selected === q.answer) {
        buttons[selected].classList.add('correct');
        score++;
      } else {
        buttons[selected].classList.add('wrong');
        buttons[q.answer].classList.add('correct');
      }

      // Show explanation
      const expDiv = document.createElement('div');
      expDiv.className = 'explanation';
      expDiv.innerHTML = '<strong>ğŸ“ è§£æï¼š</strong>' + q.explanation;
      document.querySelector('.question').appendChild(expDiv);

      // Update
      currentQuestion++;
      updateDisplay();

      setTimeout(function() {
        loadQuestion();
      }, 3000);
    }
  </script>
  <script>
    let speechRate = 0.8;
    
    function updateSpeed() {
      speechRate = parseFloat(document.getElementById('speedSlider').value);
      document.getElementById('speedValue').textContent = speechRate.toFixed(1);
    }

    const questions = [
      // Part 1: ç…§ç‰‡æè¿° (3é¡Œ)
      {
        part: 1,
        image: "part1-q1.jpg",
        text: "Look at the picture. What do you see?",
        options: ["People working in a modern office.", "The window is closed.", "There are no documents.", "Employees having lunch."],
        answer: 0,
        explanation: "åœ–ç‰‡é¡¯ç¤ºç¾ä»£è¾¦å…¬å®¤ã€‚"
      },
      {
        part: 1,
        image: "part1-q2.jpg",
        text: "Look at the picture. What do you see?",
        options: ["A bench in a park near trees.", "The park is empty.", "People playing sports.", "No trees in the area."],
        answer: 0,
        explanation: "åœ–ç‰‡é¡¯ç¤ºå…¬åœ’è£¡æœ‰é•·æ¤…å’Œæ¨¹æœ¨ã€‚"
      },
      {
        part: 1,
        image: "part1-q3.jpg",
        text: "Look at the picture. What do you see?",
        options: ["A chef cooking in the kitchen.", "Restaurant is closed.", "Stove is turned off.", "Customers waiting for food."],
        answer: 0,
        explanation: "åœ–ç‰‡é¡¯ç¤ºå»šå¸«æ­£åœ¨çƒ¹é£ªã€‚"
      },
      // Part 2: æ‡‰ç­”å•é¡Œ (3é¡Œ)
      {
        part: 2,
        question: "Could you pass me the stapler, please?",
        options: ["Sure, here you go.", "I don't know where it is.", "The meeting starts at 3 PM."],
        answer: 0,
        explanation: "é€™æ˜¯è«‹æ±‚å¥ã€‚é¸é …Aæ˜¯ç¦®è²Œçš„å›æ‡‰ã€‚"
      },
      {
        part: 2,
        question: "Thank you for helping me with the project.",
        options: ["You're welcome.", "I need more time.", "Let me check my schedule."],
        answer: 0,
        explanation: "é€™æ˜¯è¡¨é”æ„Ÿè¬ã€‚é¸é …Aæ˜¯æ¨™æº–å›æ‡‰ã€‚"
      },
      {
        part: 2,
        question: "Would you like to join us for dinner tonight?",
        options: ["That sounds great! What time?", "I'm not hungry.", "I had dinner already."],
        answer: 0,
        explanation: "é€™æ˜¯é‚€è«‹ã€‚é¸é …Aæ¥å—ä¸¦è©¢å•æ™‚é–“ã€‚"
      },
      // Part 3: ç°¡çŸ­å°è©± (3é¡Œ)
      {
        part: 3,
        text: "W: Hi John, do you have a moment? M: Sure, what's up? W: The client requested some changes. M: That shouldn't be a problem. | Q: What are they discussing?",
        options: ["A project deadline change", "A new client", "A team party"],
        answer: 0,
        explanation: "å°è©±æåˆ°å®¢æˆ¶è¦æ±‚è®Šæ›´ã€‚"
      },
      {
        part: 3,
        text: "W: Excuse me, I reserved a room. M: May I have your name? W: It's under Smith. M: Yes, we have a double room ready. | Q: Where is this?",
        options: ["At a hotel", "At a restaurant", "At a library"],
        answer: 0,
        explanation: "å°è©±æåˆ°é è¨‚æˆ¿é–“ã€‚"
      },
      {
        part: 3,
        text: "M: I'm going to the conference next week. W: What will you do there? M: I'll present our new product. | Q: What will the man do?",
        options: ["Give a presentation", "Organize the event", "Take notes"],
        answer: 0,
        explanation: "ç”·äººèªªä»–æœƒå±•ç¤ºæ–°ç”¢å“ã€‚"
      },
      // Part 4: ç°¡çŸ­ç¨ç™½ (3é¡Œ)
      {
        part: 4,
        text: "Announcement: The company picnic this Saturday has been postponed to next Sunday due to weather. Please update your calendars. | Q: Why was it postponed?",
        options: ["Due to weather forecast", "Low attendance", "Budget issues"],
        answer: 0,
        explanation: "å…¬å‘Šèªªå› ç‚ºå¤©æ°£é å ±ã€‚"
      },
      {
        part: 4,
        text: "Museum: We are open from 9 AM to 5 PM, Tuesday to Sunday. Admission is $15 for adults. Flash photography is not allowed. | Q: When is the museum closed?",
        options: ["On Mondays", "On Sundays", "On holidays"],
        answer: 0,
        explanation: "é–‹æ”¾æ™‚é–“æ˜¯é€±äºŒåˆ°é€±æ—¥ã€‚"
      },
      {
        part: 4,
        text: "Flight announcement: We are experiencing turbulence due to weather. Please keep your seatbelts fastened. We expect to land on time. | Q: What should passengers do?",
        options: ["Keep seatbelts fastened", "Stand up", "Move to exit"],
        answer: 0,
        explanation: "æ©Ÿé•·è¦æ±‚ä¹˜å®¢ç¹«å¥½å®‰å…¨å¸¶ã€‚"
      }
    ];

    let currentQuestion = 0;
    let score = 0;
    let answered = false;

    // éš¨æ©Ÿæ’åºé¡Œç›®
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }
    shuffleArray(questions);
    
    // åˆå§‹åŒ–
    currentQuestion = 0;
    score = 0;
    updateProgress();
    updateScore();

    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US';
      utterance.rate = speechRate;
      speechSynthesis.speak(utterance);
    }

    function updateProgress() {
      const progress = ((currentQuestion) / questions.length) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
      document.getElementById('progressText').textContent = 'é€²åº¦: ' + currentQuestion + ' / ' + questions.length;
    }

    function updateScore() {
      document.getElementById('currentScore').textContent = score;
      document.getElementById('totalQuestions').textContent = questions.length;
      
      if (currentQuestion > 0) {
        const percentage = Math.round((score / currentQuestion) * 100);
        const estimate = Math.round(200 + (percentage * 7.9));
        document.getElementById('scoreEstimate').textContent = 'é ä¼°å¤šç›Šåˆ†æ•¸: ' + estimate + ' - ' + (estimate + 45) + ' åˆ†';
      } else {
        document.getElementById('scoreEstimate').textContent = 'é ä¼°å¤šç›Šåˆ†æ•¸: ---';
      }
    }

    function loadQuestion() {
      if (currentQuestion >= questions.length) {
        document.getElementById('quiz').innerHTML = `
          <div class="question">
            <h2>ğŸ‰ æ¸¬é©—å®Œæˆï¼</h2>
            <p>æœ€çµ‚å¾—åˆ†: ${score} / ${questions.length}</p>
            <p class="estimate">${document.getElementById('scoreEstimate').textContent}</p>
            <button class="play-btn" onclick="location.reload()">é‡æ–°é–‹å§‹</button>
          </div>
        `;
        return;
      }

      answered = false;
      const q = questions[currentQuestion];
      
      updateProgress();
      updateScore();

      const questionText = q.question || q.text;

      document.getElementById('quiz').innerHTML = `
        <div class="question-image">
          ${q.image ? `<img src="${q.image}" alt="Question image" style="max-width:100%; border-radius:8px; margin-bottom:15px;">` : ''}
        </div>
        <div class="question">
          <h3>é¡Œç›® ${currentQuestion + 1} / ${questions.length}</h3>
          <button class="play-btn" onclick="speak('${questionText.replace(/'/g, "\\'")}')">ğŸ”Š æ’­æ”¾é¡Œç›®</button>
          <div class="options" id="optionsContainer">
            ${q.options.map((opt, i) => 
              `<button onclick="checkAnswer(${i})" id="opt${i}">${String.fromCharCode(65+i)}. ${opt}</button>`
            ).join('')}
          </div>
        </div>
      `;
    }

    function checkAnswer(selected) {
      if (answered) return;
      answered = true;
      
      const q = questions[currentQuestion];
      const buttons = document.querySelectorAll('.options button');
      
      if (selected === q.answer) {
        buttons[selected].classList.add('correct');
        score++;
      } else {
        buttons[selected].classList.add('wrong');
        buttons[q.answer].classList.add('correct');
      }

      // é¡¯ç¤ºè§£æ
      const explanationDiv = document.createElement('div');
      explanationDiv.className = 'explanation';
      explanationDiv.innerHTML = '<strong>ğŸ“ è§£æï¼š</strong>' + q.explanation;
      document.querySelector('.question').appendChild(explanationDiv);

      updateScore();

      setTimeout(() => {
        currentQuestion++;
        loadQuestion();
      }, 3000);
    }
  </script>
</body>
</html>
